#!/usr/bin/env ruby

require_relative "../lib/push_event"

raw_event = File.read(ENV.fetch("GITHUB_EVENT_PATH"))
file_path = ARGV.first
push_event = PushEvent.new(raw_event)

unless push_event.valid?
  puts "ERROR: This Action can only be run as part of a workflow triggered by a push event."
  exit(1)
end

puts "Checking if #{file_path} was modified in this push..."

if push_event.modified?(file_path)
  puts "#{file_path} was modified"
  exit(0)
else
  puts "#{file_path} was not modified"
  exit(1)
end
